<div *ngIf="clientInfo!=undefined" class="row">
  <div class="col-md-12">
    <nb-card [nbSpinner]="loading" nbSpinnerStatus="info" nbSpinnerSize="giant">
      <nb-card-header class="puff_center">
        <div class="clearfix">
          <strong>Datos cliente</strong>
          
          <button type="button" class="btn btn-outline-success float-right" *ngIf="!clientInfo.activo &&  module != 'promotor'" (click)="toggleOn()">Activar</button>
          <button type="button" class="btn btn-outline-danger float-right" *ngIf="clientInfo.activo &&  module != 'promotor'" (click)="toggleOff()">Desactivar</button>
          <div class="alert alert-warning float-right" *ngIf="dataFile === undefined" role="alert">
            El cliente no cuenta con comprobante de situación fiscal, favor de cargarlo en la sección de datos adicionales o agregar una nota con una justificación válida.
          </div>
        </div>

      </nb-card-header>
      <nb-card-body>

        <strong>Datos generales del cliente</strong>

        <br>
        <div class="row slide_1">
          <div class="col-md-4">
            <div class="form-group">
              <label for="inputRFC" class="label">RFC</label>
              <input type="text" [(ngModel)]="clientInfo.informacionFiscal.rfc" [disabled]="clientInfo.id !== undefined" nbInput fullWidth id="inputRFC"
                placeholder="RFC cliente">
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <label for="inputSocialReason" class="label">Razón Social</label>
              <input type="text" [(ngModel)]="clientInfo.informacionFiscal.razonSocial" nbInput fullWidth [disabled]="clientInfo.activo"
                id="inputSocialReason" placeholder="Razón Social">
            </div>
          </div>
          <div class="col-sm-2">
            <label for="inputPais" class="label">País</label>
            <nb-select id="inputPais" selected="0" fullWidth style="display:block;" [disabled]="clientInfo.activo">
              <nb-option value="0">México</nb-option>
            </nb-select>
          </div>
          
        </div>
        <div class="row slide_2">
          <div class="col-sm-2">
            <div class="form-group">
              <label for="inputZipCode" class="label">Código Postal</label>
              <input type="text" [(ngModel)]="clientInfo.informacionFiscal.cp" (ngModelChange)="zipCodeInfo($event)" [disabled]="clientInfo.activo"
                nbInput fullWidth id="inputZipCode" placeholder="00300">
            </div>
          </div>
          <div [ngClass]="{'col-sm-4': formInfo.coloniaId !=='other', 'col-sm-2': formInfo.coloniaId ==='other'}" *ngIf="clientInfo.id === undefined || !clientInfo.activo">
            <div class="form-group">
              <label for="inputColonia" class="label">Seleccionar colonia</label>
              <nb-select id="inputColonia" [(ngModel)]="formInfo.coloniaId" fullWidth [disabled]="clientInfo.activo"
                (selectedChange)="onLocation($event)" style="display:block;">
                <nb-option value="*">Seleccionar</nb-option>
                <nb-option *ngFor="let colonia of colonias; let i = index" [value]="i">{{colonia}}</nb-option>
                <nb-option value="other">Otra</nb-option>
              </nb-select>
            </div>
          </div>
          
          <div [ngClass]="{'col-sm-4': formInfo.coloniaId !=='other', 'col-sm-3': formInfo.coloniaId ==='other'}"  *ngIf="clientInfo.activo || formInfo.coloniaId==='other'">
            <div class="form-group">
              <label for="inputLocalidad" class="label">Colonia</label>
              <input type="text" [(ngModel)]="clientInfo.informacionFiscal.localidad" nbInput fullWidth [disabled]="clientInfo.activo"
                id="inputLocalidad" placeholder="Escriba la colonia">
            </div>
          </div>
          <div class="col-sm-2">
            <label for="inputState" class="label">Estado</label>
            <input type="text" [(ngModel)]="clientInfo.informacionFiscal.estado" nbInput fullWidth id="inputState" [disabled]="clientInfo.activo"
              placeholder="Estado">
          </div>
          <div class="col-sm-3">
            <div class="form-group">
              <label for="inputCity" class="label">Municipio/Delegación</label>
              <input type="text" [(ngModel)]="clientInfo.informacionFiscal.municipio" nbInput fullWidth id="inputCity" [disabled]="clientInfo.activo"
                placeholder="Municipio/Delegación">
            </div>
          </div>
        </div>
        
        <div class="row slide_4">
          <div class="col-md-6">
            <div class="form-group">
              <label for="inputCalle" class="label">Calle</label>
              <input type="text" [(ngModel)]="clientInfo.informacionFiscal.calle" nbInput fullWidth id="inputCalle" [disabled]="clientInfo.activo"
                placeholder="Calle">
            </div>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label for="inputExterior" class="label">No. exterior</label>
              <input type="text" [(ngModel)]="clientInfo.informacionFiscal.noExterior" nbInput fullWidth [disabled]="clientInfo.activo"
                id="inputExterior" placeholder="No. exterior">
            </div>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label for="inputInterior" class="label">No. interior</label>
              <input type="text" [(ngModel)]="clientInfo.informacionFiscal.noInterior" nbInput fullWidth [disabled]="clientInfo.activo"
                id="inputInterior" placeholder="No. interior">
            </div>
          </div>
        </div>
        <div class="row slide_3">
          <div class="col-sm-6">
            <div class="form-group">
              <label for="inputEmail" class="label">Correo Cliente</label>
              <input type="email" [(ngModel)]="clientInfo.informacionFiscal.correo" nbInput fullWidth id="inputEmail" [disabled]="clientInfo.activo"
                placeholder="Email">
            </div>
          </div>
        </div>

  
        <strong>Comisiones del cliente</strong>
        <div class="row slide_4">
          <div class="col-sm-3">
            <div class="form-group">
              <label for="inputPromotor" class="label">Promotor</label>
              <input type="number" nbInput fullWidth [(ngModel)]="clientInfo.porcentajePromotor" id="inputPromotor" [disabled]="clientInfo.activo || module === 'operaciones'" 
                placeholder="4" min="0" max="8">
            </div>
          </div>
          <div class="col-sm-3">
            <div class="form-group">
              <label for="inputCliente" class="label">Cliente</label>
              <input type="number" nbInput fullWidth [(ngModel)]="clientInfo.porcentajeCliente" id="inputCliente" [disabled]="clientInfo.activo || module === 'operaciones'"
                placeholder="4" min="0" max="8">
            </div>
          </div>
          <div class="col-sm-3">
            <div class="form-group">
              <label for="inputdespacho" class="label">Despacho</label>
              <input type="number" nbInput fullWidth [(ngModel)]="clientInfo.porcentajeDespacho" id="inputdespacho" [disabled]="clientInfo.activo || module === 'operaciones'"
                placeholder="4" min="0" max="16">
            </div>
          </div>
          <div class="col-sm-3">
            <div class="form-group">
              <label for="inputContacto" class="label">Contacto</label>
              <input type="number" nbInput fullWidth [(ngModel)]="clientInfo.porcentajeContacto" id="inputContacto" [disabled]="clientInfo.activo || module === 'operaciones'"
                placeholder="4" min="0" max="4">
            </div>
          </div>
        </div>
        <br>
        <strong>Notas adicionales</strong>
        <br>
        <div class="row slide_4">
          <div class="col-sm-6">
            <div class="form-group">
              <label for="inputNotes" class="label">Notas cliente</label>
              <textarea type="text" [(ngModel)]="clientInfo.notas" nbInput fullWidth id="inputNotes" [disabled]="clientInfo.activo" maxlength="280" cols="3"
                placeholder="Notas adicionales cliente"></textarea>
            </div>
          </div>
          <div class="form-group col-sm-6">
            <label for="certFile" class="label">Comprobante cedula fiscal</label>

            <div class="input-group">
              <div class="custom-file" id="documentFile">
                <input type="file" class="custom-file-input" id="documentFile" [disabled]="clientInfo.activo" 
                  accept=".pdf,.xls,.xlsx,.doc, .docx,image/*" (change)="fileDataUploadListener($event)"
                  style="display:block;" aria-describedby="inputDocFile">
                <label class="custom-file-label" style="background-color: #f7f9fc;" for="inputDocFile">{{formInfo.fileDataName}}</label>
              </div>
            </div>
            <button class="btn d-inline btn-outline-success mt-2 ml-2 mr-2" (click)="uploadFile()" *ngIf="clientInfo.id !== undefined" [disabled]="clientInfo.activo || formInfo.fileDataName.length == 0">
              <i class="fa fa-upload"></i></button>
            <button class="btn d-inline btn-outline-primary mt-2 ml-2 mr-2" (click)="downloadFile()" *ngIf="clientInfo.id !== undefined" [disabled]="clientInfo.activo || !dataFile">
                <i class="fa fa-download"></i></button>
          </div>
        </div>

        
        <div class="puff_center" class="form-inline">
          <button type="button" *ngIf="clientInfo.id === undefined && module === 'promotor'"
            [disabled]="(clientInfo.porcentajeContacto + clientInfo.porcentajeDespacho + clientInfo.porcentajeCliente + clientInfo.porcentajePromotor) !== 16 && formInfo.message !== undefined"
            (click)="insertClient()" nbButton status="primary">GUARDAR</button>
          <button type="button"  *ngIf="clientInfo.id !== undefined && !clientInfo.activo" [disabled]="(clientInfo.porcentajeContacto + clientInfo.porcentajeDespacho + clientInfo.porcentajeCliente + clientInfo.porcentajePromotor) !== 16 && formInfo.message !== undefined" (click)="updateClient()" nbButton
            status="primary">ACTUALIZAR</button>
        </div>
      </nb-card-body>
    </nb-card>
  </div>
</div>